import { useState, useEffect } from 'react';
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';
export default function USDA(){
  const [data,setData]=useState([]);const [error,setError]=useState('');
  useEffect(()=>{(async()=>{try{setError('');const r=await fetch('http://localhost:5050/api/usda/prices');if(!r.ok)throw new Error('HTTP '+r.status);setData(await r.json());}catch(e){setData(Array.from({length:26},(_,i)=>({week:'W'+(i+1),current:10+Math.random()*5,avg5yr:9+Math.random()*4})));setError('Fallback data');}})();},[]);
  return(<div className='card'><h2>USDA Prices</h2>{error&&<div style={{color:'red'}}>{error}</div>}<ResponsiveContainer width='100%' height={400}><LineChart data={data}><CartesianGrid strokeDasharray='3 3'/><XAxis dataKey='week'/><YAxis/><Tooltip/><Legend/><Line type='monotone' dataKey='current' stroke='#2563eb' strokeWidth={2}/><Line type='monotone' dataKey='avg5yr' stroke='#16a34a' strokeDasharray='5 5' strokeWidth={2}/></LineChart></ResponsiveContainer></div>);
}